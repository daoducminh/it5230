{% extends "base/default.html" %}

{% load static %}

{% block title %}Menu{% endblock %}

{% block style %}
    <link rel="stylesheet" href="{% static 'css/menu/edit.css' %}">
{% endblock %}

{% block content %}
    <div class="container">
        <div class="mt-2">
            <h2 class="text-uppercase">{{ title }}</h2>
        </div>
        <hr/>
        <div class="row">
            <div class="col-12 col-md-6">
                <div class="my-2">
                    <h5 class="border-bottom pb-2">Describe your menu</h5>
                    <form class="mt-3" id="menu-info-form">
                        <div class="form-group">
                            <label for="menu-name">Menu name</label>
                            <input class="form-control" type="text"
                                   name="menu_name" value="{{ menu.menu_name }}"
                                   id="menu-name" maxlength="100"
                                   placeholder="Menu name" required>
                        </div>
                        <div class="form-group">
                            <label for="description">Description</label>
                            <textarea class="form-control" name="description"
                                      id="description" maxlength="1000"
                                      placeholder="Description" required
                            >{{ menu.description }}</textarea>
                        </div>
                    </form>
                </div>
                <div class="my-2">
                    <h5 class="border-bottom pb-2">Recipes</h5>
                    <div id="recipe-list" class="mt-3">
                        {% for r in recipes %}
                            <div class="alert alert-dismissible fade show recipe-item">
                                <a class="row link-decoration-none" href="{% url 'recipe_detail' r.pk %}">
                                    <div class="col-3 recipe-img">
                                        {% if r.image %}
                                            <img src="{{ r.image.url }}" alt="" class="img-fluid img-thumbnail">
                                        {% else %}
                                            <img src="{{ r.image_url|default:'/media/default.jpg' }}"
                                                 alt="" class="img-fluid img-thumbnail">
                                        {% endif %}
                                    </div>
                                    <div class="col-9 d-flex flex-column justify-content-between">
                                        <div>{{ r.recipe_name }}</div>
                                        <div>
                                            {% for s in 12345|make_list %}
                                                {% if forloop.counter <= r.round_score %}
                                                    <i class="fas fa-star fa-star-gold"></i>
                                                {% else %}
                                                    <i class="far fa-star fa-star-gold"></i>
                                                {% endif %}
                                            {% endfor %}
                                            <span class="text-danger">({{ r.review_number }})</span>
                                        </div>
                                    </div>
                                </a>
                                <div>
                                    <button type="button" class="btn-remove-recipe" data-dismiss="alert"
                                            aria-label="close"
                                            onclick="removeRecipe({{ r.pk }})">
                                        &times;
                                    </button>
                                </div>
                                <input type="hidden" value="{{ r.pk }}">
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-6">
                <div class="my-2">
                    <h5 class="border-bottom pb-2">Find your favorite recipes!</h5>
                    <div class="input-group my-3">
                        <input class="form-control" type="text" name="search" id="input-recipe" aria-label="">
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary" id="btn-search">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                    <div id="search-result"></div>
                </div>
            </div>
        </div>
        <div class="row d-flex flex-column flex-md-row justify-content-md-end">
            <button class="btn btn-success m-3" id="btn-submit">Save</button>
            <a class="btn btn-danger m-3" href="{{ request.META.HTTP_REFERER }}">Discard change</a>
        </div>
        <div class="modal fade" id="message-modal" tabindex="-1"
             aria-labelledby="messageModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="form">
                <div class="modal-content p-3">
                    <div class="modal-body">
                        <div id="message-content"></div>
                        <hr>
                        <div class="mt-3">
                            Please <a href="{{ request.META.HTTP_REFERER }}">click here</a> if you are not redirected
                            after few seconds.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block pre_script %}
    <script src="{% static 'js/menu/pre-edit.js' %}"></script>
{% endblock %}

{% block script %}
    <script src="{% static 'js/menu/edit.js' %}"></script>
{% endblock %}