{% extends "base/default.html" %}

{% block title %}Recipe{% endblock %}

{% block content %}
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-sm-6">
                <div class="mt-3">
                    <h2 class="text-center">New recipe</h2>
                </div>
                <hr>
                {% if form %}
                    {% for field in form %}
                        {% if field.errors %}
                            <div class="alert alert-danger alert-dismissible">
                                <button type="button" class="close" data-dismiss="alert">&times;</button>
                                <div>{{ field.label_tag }} {{ field.errors }}</div>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endif %}
                <form action="" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="form-group row">
                        <label for="input-recipe-name" class="col-sm-3 col-12">Recipe name:</label>
                        <div class="col-sm-9 col-12">
                            <input type="text" class="form-control" id="input-recipe-name" name="recipe_name" value=""
                                   required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="input-description" class="col-sm-3 col-12">Description:</label>
                        <div class="col-sm-9 col-12">
                            <input type="text" class="form-control" id="input-description" name="description"
                                   value="" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="input-calories" class="col-sm-3 col-12">Calories (kcal):</label>
                        <div class="col-sm-9 col-12">
                            <input type="number" class="form-control" id="input-calories" name="calories" value=""
                                   required
                                   min="0">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="input-ingredients" class="col-sm-3 col-12">Ingredients:</label>
                        <div class="col-sm-9 col-12">
                            <input type="text" class="form-control" id="input-ingredients" name="ingredients"
                                   value="" required>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="input-image" class="col-sm-3 col-12">Images:</label>
                        <div class="col-12 col-sm-9">
                            <input type="file" class="form-control-file" id="input-image" name="image" required>
                            <div class="mt-3" id="preview-image"></div>
                        </div>

                    </div>
                    <div class="form-group row">
                        <div class="col-sm-3 col-12"></div>
                        <div class="col-sm-4 col-12">
                            <button type="submit" class="btn btn-primary btn-block">Create new recipe</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block script %}
    <script>
        $(document).ready(() => {
            const inputImage = $('#input-image');
            inputImage.change(() => {
                const [file] = inputImage[0].files;
                if (file) {
                    const src = URL.createObjectURL(file);
                    $('#preview-image').html(`<img src="${src}" class="img-fluid">`)
                }
            })
        })
    </script>
{% endblock %}